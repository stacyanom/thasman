<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Niko's Room ‚Äî SeeN</title>
<style>
/* === Core styling unchanged from your previous version === */
body{margin:0;background:#000;color:#111;font:14px/1.4 "MS Sans Serif","Segoe UI",Tahoma,sans-serif;overflow-y:auto;}
body::before{content:"";position:fixed;inset:0;background:url("game over screen no text.png") center/cover no-repeat;transform-origin:center;animation:drift 80s ease-in-out infinite alternate;filter:brightness(.4) contrast(1.3) saturate(1.15);z-index:-3;}
body::after{content:"";position:fixed;inset:0;background:repeating-linear-gradient(0deg,rgba(255,0,0,.06)0 2px,rgba(0,0,0,.25)2px 3px);mix-blend-mode:overlay;animation:flicker 18s infinite;opacity:.3;z-index:-2;pointer-events:none;}
@keyframes drift{0%{transform:scale(1.05) translate(0,0);}100%{transform:scale(1.12) translate(-2%,1.5%);}}
@keyframes flicker{0%,100%{opacity:.3;}50%{opacity:.15;}}
:root{--win95-gray:#c3c3c3;--win95-dark:#000;--accent:#8b0000;}
.main{padding:60px 0 80px;display:flex;justify-content:center;}
.window{background:var(--win95-gray);border:2px solid var(--win95-dark);box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff,6px 6px 0 rgba(0,0,0,.3);width:min(960px,95%);margin:0 auto 100px;}
.titlebar{background:linear-gradient(#000,#1a1a1a);color:#fff;padding:.4rem .6rem;display:flex;justify-content:space-between;align-items:center;font-weight:700;text-transform:uppercase;letter-spacing:.05em;}
.buttons{display:flex;gap:4px;}
.btn{width:16px;height:16px;background:#c0c0c0;border:1px solid #000;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;display:flex;align-items:center;justify-content:center;cursor:pointer;user-select:none;font-size:12px;}
.btn:active{box-shadow:inset 1px 1px 0 #7b7b7b,inset -1px -1px 0 #fff;transform:translateY(1px);}
.btn-close{background:#ff0000;border-color:#7b0000 #000 #000 #7b0000;}
.btn-close .icon{color:white;}
.icon{font-weight:bold;font-size:12px;color:black;}
.bloodline{height:2px;background:repeating-linear-gradient(90deg,var(--accent),var(--accent)6px,transparent 6px,transparent 10px);}
.content{display:grid;grid-template-columns:260px 1fr;gap:16px;padding:16px;}
@media(max-width:760px){.content{grid-template-columns:1fr;}}
.art-wrap{border:2px solid #000;overflow:hidden;}
.art{width:110%;height:auto;display:block;margin:0 auto;aspect-ratio:1/1;filter:contrast(1.05) brightness(.9);}
.meta{margin-top:10px;padding:10px;background:#d6d6d6;border:2px solid #000;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;}
.meta h1{margin:0 0 4px;font-size:20px;}
.artist{font-weight:700;color:#333;}
.badge{display:inline-block;margin-top:6px;padding:2px 6px;border:1px dashed var(--accent);color:var(--accent);background:#ececec;font-size:11px;text-transform:uppercase;}
.volume-control{display:flex;align-items:center;gap:8px;background:#dcdcdc;border:2px solid #000;padding:6px 10px;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;margin-top:12px;}
.volume-icon{font-size:16px;width:20px;text-align:center;}
#volume{width:100%;max-width:200px;}
.controls-under-volume{display:flex;justify-content:center;gap:8px;margin-top:12px;}
.panel{background:#dcdcdc;border:2px solid #000;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;padding:12px;display:flex;flex-direction:column;gap:12px;}
.btn-95{border:2px solid #000;background:#c0c0c0;padding:6px 10px;cursor:pointer;font-weight:700;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;}
.btn-95:active{box-shadow:inset 1px 1px 0 #7b7b7b,inset -1px -1px 0 #fff;transform:translateY(1px);}
.btn-danger{color:var(--accent);}
.controls{display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:space-between;}
.loop-btn{cursor:pointer;font-size:16px;background:#c0c0c0;border:2px solid #000;padding:4px 8px;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;}
.timebar{display:grid;grid-template-columns:44px 1fr 44px;align-items:center;gap:8px;}
.time{font-variant-numeric:tabular-nums;text-align:center;background:#ececec;border:1px solid #000;padding:2px 4px;}
input[type=range]{-webkit-appearance:none;height:18px;background:#c0c0c0;border:2px solid #000;box-shadow:inset -1px -1px 0 #7b7b7b,inset 1px 1px 0 #fff;width:100%;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:10px;height:18px;background:var(--accent);border:1px solid #000;}
input[type=range]::-moz-range-thumb{width:10px;height:18px;background:var(--accent);border:1px solid #000;}
.tooltip{position:absolute;background:#ffffe1;border:1px solid #000;padding:2px 6px;font-size:11px;box-shadow:2px 2px 0 rgba(0,0,0,.3);pointer-events:none;display:none;z-index:50;}
.tracklist{margin:0;padding:0;list-style:none;border:1px solid #000;background:#e9e9e9;max-height:370px;overflow:auto;}
.track{display:grid;grid-template-columns:28px 1fr auto;gap:10px;align-items:center;padding:8px 10px;border-bottom:1px solid #c9c9c9;cursor:pointer;}
.track:hover{background:#dcdcdc;}
.track.active{background:linear-gradient(#cfcfcf,#bfbfbf);outline:1px solid var(--accent);}
.footer{padding:8px 12px;border-top:2px solid #000;background:#c7c7c7;display:flex;justify-content:space-between;align-items:center;font-size:12px;}
.blink{color:var(--accent);font-weight:800;animation:blink 1.2s steps(1) infinite;}
@keyframes blink{50%{opacity:.25}}
</style>
</head>
<body>
<div class="main">
  <div class="window">
    <div class="titlebar">
      <div>Niko's Room ‚Äî SeeN</div>
      <div class="buttons">
        <div class="btn"><span class="icon">_</span></div>
        <div class="btn"><span class="icon">‚ñ¢</span></div>
        <div class="btn btn-close"><span class="icon">√ó</span></div>
      </div>
    </div>
    <div class="bloodline"></div>

    <div class="content">
      <div>
        <div class="art-wrap"><img src="NIKO Cover.png" class="art" alt="Album art"></div>
        <div class="meta">
          <h1>Niko's Room</h1>
          <div class="artist">SeeN</div>
          <div class="badge">Brought to you by Tha SMaN</div>
        </div>

        <div class="volume-control">
          <span class="volume-icon" id="volumeIcon">üîâ</span>
          <input type="range" id="volume" min="0" max="100" value="70">
        </div>

        <div class="controls-under-volume">
          <button class="btn-95" id="prevBtn">‚èÆ Prev</button>
          <button class="btn-95 btn-danger" id="playPauseBtn">‚ñ∂ Play</button>
          <button class="btn-95" id="nextBtn">Next ‚è≠</button>
        </div>
      </div>

      <div class="panel">
        <div class="controls">
          <span id="nowPlaying" style="font-weight:700">Loading‚Ä¶</span>
          <button class="loop-btn" id="loopBtn" title="No Loop">üö´</button>
        </div>

        <!-- Updated timebar -->
        <div class="timebar">
          <div class="time" id="elapsed">0:00</div>
          <input type="range" id="seek" min="0" max="1000" value="0">
          <div class="time" id="remaining">-0:00</div>
        </div>

        <ol class="tracklist" id="tracklist"></ol>
      </div>
    </div>

    <div class="footer">
      <div>¬© <span id="year"></span> SeeN ‚Äî Niko's Room</div>
      <div><span class="blink">‚ñå</span> m3d0k1N</div>
    </div>
  </div>
</div>

<audio id="player" preload="metadata"></audio>
<div id="tooltip" class="tooltip"></div>

<script>
const album={title:"Niko's Room",artist:"SeeN",tracks:[
  {title:"Enjoy The Show (Intro)",file:"track01.mp3"},
  {title:"N.I.K.O.",file:"track02.mp3"},
  {title:"New Heights",file:"track03.mp3"},
  {title:"Northern Star",file:"track04.mp3"},
  {title:"Vegas (Interlude)",file:"track05.mp3"},
  {title:"Carousel",file:"track06.mp3"},
  {title:"PANIC ATTACK",file:"track07.mp3"},
  {title:"Mind Control (Album Version)",file:"track08.mp3"},
  {title:"Candle Light",file:"track09.mp3"},
  {title:"Tha SMaN",file:"track10.mp3"}
]};

const player=document.getElementById('player'),
tracklist=document.getElementById('tracklist'),
playPause=document.getElementById('playPauseBtn'),
prev=document.getElementById('prevBtn'),
next=document.getElementById('nextBtn'),
seek=document.getElementById('seek'),
elapsed=document.getElementById('elapsed'),
remaining=document.getElementById('remaining'),
nowPlaying=document.getElementById('nowPlaying'),
volume=document.getElementById('volume'),
volumeIcon=document.getElementById('volumeIcon'),
loopBtn=document.getElementById('loopBtn'),
tooltip=document.getElementById('tooltip'),
slider=document.getElementById('volume');

document.getElementById('year').textContent=new Date().getFullYear();

let idx=0,durs=new Array(album.tracks.length).fill(null),seeking=false;
let loopMode="none";

const fmt=s=>{s=Math.floor(s||0);return`${Math.floor(s/60)}:${(s%60).toString().padStart(2,'0')}`};

function render(){
  tracklist.innerHTML="";
  album.tracks.forEach((t,i)=>{
    let li=document.createElement('li');
    li.className='track';
    li.dataset.i=i;
    li.innerHTML=`<span class="idx">${(i+1).toString().padStart(2,"0")}</span><span>${t.title}</span><span class="dur" id="dur-${i}">${durs[i]?fmt(durs[i]):'--:--'}</span>`;
    li.onclick=()=>loadPlay(i);
    tracklist.appendChild(li);
  });
  updateActive();
}
function updateActive(){[...tracklist.children].forEach(li=>li.classList.toggle('active',+li.dataset.i===idx));}

function load(i){
  idx=(i+album.tracks.length)%album.tracks.length;
  player.src=album.tracks[idx].file;
  nowPlaying.textContent=`Now Playing: ${(idx+1).toString().padStart(2,'0')} ‚Äî ${album.tracks[idx].title}`;
  document.title=`${album.title} ‚Äî ${album.tracks[idx].title} ‚Ä¢ SeeN`;
  updateActive();
  seek.value=0;
  elapsed.textContent='0:00';
  remaining.textContent=durs[idx]?`-${fmt(durs[idx])}`:'--:--';
}
function loadPlay(i){load(i);player.play();}
playPause.onclick=()=>player.paused?player.play():player.pause();
prev.onclick=()=>loadPlay(idx-1);
next.onclick=()=>loadPlay(idx+1);
player.onplay=()=>playPause.textContent='‚è∏ Pause';
player.onpause=()=>playPause.textContent='‚ñ∂ Play';

player.ontimeupdate=()=>{
  if(seeking)return;
  if(isFinite(player.duration)){
    const current=player.currentTime;
    const remain=Math.max(0,player.duration-current);
    elapsed.textContent=fmt(current);
    remaining.textContent=`-${fmt(remain)}`;
    seek.value=current/player.duration*1000;
  }
};

player.volume=volume.value/100;
function updateVolumeIcon(){
  const v=player.volume;
  volumeIcon.textContent=v===0?'üîá':v<0.3?'üîà':v<0.7?'üîâ':'üîä';
}
volume.oninput=()=>{player.volume=volume.value/100;updateVolumeIcon();};
updateVolumeIcon();

function showTooltip(e){
  const rect=slider.getBoundingClientRect();
  tooltip.textContent=`Volume: ${slider.value}%`;
  tooltip.style.left=`${e.pageX+12}px`;
  tooltip.style.top=`${rect.top+window.scrollY-28}px`;
  tooltip.style.display='block';
}
slider.addEventListener('mousemove',showTooltip);
slider.addEventListener('input',showTooltip);
slider.addEventListener('mouseleave',()=>tooltip.style.display='none');

loopBtn.addEventListener('click',()=>{
  if(loopMode==="none"){loopMode="all";loopBtn.textContent="üîÅ";loopBtn.title="Loop All";}
  else if(loopMode==="all"){loopMode="one";loopBtn.textContent="üîÇ";loopBtn.title="Loop One";}
  else{loopMode="none";loopBtn.textContent="üö´";loopBtn.title="No Loop";}
});

player.onended = () => {
  if (loopMode === "one") {
    // Repeat current track
    player.currentTime = 0;
    player.play();
  } else if (loopMode === "all") {
    // Normal album loop
    loadPlay(idx + 1);
  } else {
    // "No Loop" mode ‚Äî play next track, and restart from beginning at the end
    if (idx < album.tracks.length - 1) {
      loadPlay(idx + 1);
    } else {
      // At the end, restart from track 1 automatically
      loadPlay(0);
    }
  }
};


album.tracks.forEach((t,i)=>{
  const a=new Audio(t.file);
  a.preload='metadata';
  a.onloadedmetadata=()=>{
    durs[i]=a.duration;
    const el=document.getElementById(`dur-${i}`);
    if(el)el.textContent=fmt(a.duration);
  };
});

seek.oninput=()=>{seeking=true;player.currentTime=(seek.value/1000)*(player.duration||0);};
seek.onchange=()=>{seeking=false;};
window.onkeydown=e=>{
  switch(e.code){
    case"Space":e.preventDefault();playPause.onclick();break;
    case"ArrowLeft":player.currentTime=Math.max(0,player.currentTime-5);break;
    case"ArrowRight":player.currentTime=Math.min(player.duration,player.currentTime+5);break;
    case"KeyN":loadPlay(idx+1);break;
    case"KeyP":loadPlay(idx-1);break;
  }
};
// === Window Control Buttons ===
const minimizeBtn = document.querySelector('.buttons .btn:nth-child(1)');
const maximizeBtn = document.querySelector('.buttons .btn:nth-child(2)');
const closeBtn = document.querySelector('.btn-close');
const mainWindow = document.querySelector('.window');

// --- CRT flicker animation effect ---
const addCRTEffect = (el) => {
  el.style.transition = "transform 0.35s ease, filter 0.35s ease";
  el.style.transform = "scale(0.95)";
  el.style.filter = "brightness(1.6) contrast(1.3)";
  setTimeout(() => {
    el.style.transform = "scale(1)";
    el.style.filter = "none";
  }, 300);
};

// Close (confirmation and fallback)
closeBtn.addEventListener('click', () => {
  if (confirm("Are you sure you want to close Niko's Room?")) {
    window.close();
    // fallback if browser blocks tab close
    document.body.innerHTML = '<div style="color:white;text-align:center;margin-top:20vh;font-family:MS Sans Serif">[ ‚úñ ] Niko\'s Room has been closed.</div>';
  }
});

// Maximize (toggle fullscreen)
maximizeBtn.addEventListener('click', async () => {
  addCRTEffect(mainWindow);
  if (!document.fullscreenElement) {
    await mainWindow.requestFullscreen().catch(() => {});
  }
});

// Minimize (exit fullscreen)
minimizeBtn.addEventListener('click', () => {
  addCRTEffect(mainWindow);
  if (document.fullscreenElement) {
    document.exitFullscreen().catch(() => {});
  }
});

render();load(0);
</script>
</body>
</html>

